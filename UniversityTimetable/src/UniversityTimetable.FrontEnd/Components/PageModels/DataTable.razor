@inherits IndexPageBase<TData, TParameters>
@typeparam TData
@typeparam TParameters
@if (Data is null)
{
    <p><em>Loading...</em></p>
    return;
}
@if (CreateLink is not null && _isAdmin)
{
    <p>
        <a href="@CreateLink">Create new</a>
    </p>
}
<table>
    <thead>
    @foreach (var searchTerm in SearchTerms)
    {
        <InputText Value="@searchTerm.Item2.GetFromExpression(Parameters)"
                   ValueChanged="@(s => searchTerm.Item2.SetFromExpression(Parameters, s))"
                   ValueExpression="searchTerm.Item2.SetLambdaParameter(Parameters)" @onblur="RefreshData"
                   style="background-color: rgb(235, 235, 235)" placeholder="@searchTerm.placeHolder"/>
    }
    <tr>
        @foreach (var header in TableHeaders)
        {
            <th>
                @header
            </th>
        }
        @if (TotalLinks != 0)
        {
            <th></th>
        }
    </tr>
    </thead>
    <tbody>
        @foreach (var item in Data.Data)
        {
            <tr>
                @foreach(var data in TableData)
                {
                    <td>
                        @data(item)
                    </td>
                }
                <td>
                    @if (EditLink is not null && _isAdmin && ShowEditButton)
                    {
                        <a role="button" href="@($"{EditLink}/{item.Id}")" class="btn btn-info">Edit</a>
                        <text> | </text>
                    }
                    @foreach(var link in ActionLinks)
                    {
                        <a role="button" href="@link.LinkSource(item)" class="btn btn-info">@link.LinkName</a>
                        <text> | </text>
                    }
                    @if (_isAdmin && ShowDeleteButton)
                    {
                        <a role="button" class="btn btn-danger" onclick="@(() => Delete(item.Id))">Delete</a>
                    }
                </td>
            </tr>
        }
    </tbody>
    <DataPageSelect TotalPages="Data.Metadata.MaxPageNumber" OnPageNumberChanged="@(PageNumberChanged)" />
    <br />
    <DataPageSizeSelect OnPageSizeChanged="@(PageSizeChanged)" PageSize="Parameters.PageSize" />
</table>
